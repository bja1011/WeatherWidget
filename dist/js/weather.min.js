var weatherWidget=function(){function e(){"geolocation"in navigator?(console.log("sdf"),navigator.geolocation.getCurrentPosition(function(e){t("weather",e.coords.latitude,e.coords.longitude,function(e){n(e)}),t("forecast/daily",e.coords.latitude,e.coords.longitude,function(e){r(e)})},function(){I.style.display="block"})):I.style.display="block"}function t(e,t,n,r,a){var o="http://api.openweathermap.org/data/2.5/"+e;o+=a?"?q="+a+"&lang=pl&appid=1929fffb238baf259922bfbb99ae5a73":"?lat="+t+"&lang=pl&lon="+n+"&appid=1929fffb238baf259922bfbb99ae5a73",o+="&units="+d.units;var u=new XMLHttpRequest;u.open("GET",o),u.onload=function(){if(200===u.status){var e=JSON.parse(u.responseText);r(e)}else alert("Request failed.  Returned status of "+u.status)},u.send()}function n(e){w.style.display="none",I.style.display="none",d.currentWeatherData=e,b.innerHTML=i(e.dt),m.innerHTML=e.name,p.innerHTML=a(e.main.temp),v.innerHTML=l(e.weather[0].icon),h.innerHTML=o(e.main.pressure),g.style.transform="rotate("+e.wind.deg+"deg)",y.innerHTML=u(e.wind.speed),T.innerHTML="metric"==d.units?"imperial":"metric"}function r(e){var t="<ul>";e.list.forEach(function(e){var n=new Date(1e3*e.dt),r=parseInt(n.getDate());t+="<li><span class='date'>"+r+"</span> <span class='temp'>"+a(e.temp.max)+"</span>"+l(e.weather[0].icon)+"</li>"}),t+="</ul>",f.innerHTML=t}function a(e){var t="metric"==d.units?"&#778;C":"&#778;F";return Math.round(e)+" "+t}function o(e){return Math.round(e)+" hPa"}function u(e){var t="metric"==d.units?"m/s":"m/h";return Math.round(e)+" "+t}function i(e){var e=new Date(1e3*e),t=parseInt(e.getDate()),n=parseInt(e.getMonth()),r=["January","February","March","April","May","June","July","August","September","October","November","December"];return t+" "+r[n]}function c(){var e=new XMLHttpRequest;e.open("GET","assets/icons/icons.svg"),e.onload=function(){200===e.status?(s=document.createElement("div"),s.innerHTML=e.responseText):console.log("Error: "+e.status)},e.send()}function l(e){return s.querySelectorAll("#icon-"+e)[0].outerHTML}this.run=function(){e()};var s,d={units:"imperial",currentWeatherData:null};c();var m=document.getElementById("locationName"),f=document.getElementById("weatherForecast"),p=document.getElementById("currentTemp"),g=document.getElementById("currentWindDirection"),y=document.getElementById("currentWindSpeed"),h=document.getElementById("currentPressure"),v=document.getElementById("currentIcon"),b=document.getElementById("date"),E=document.getElementById("manualLocation"),M=document.getElementById("submit"),I=document.getElementById("manualLocationForm"),w=document.getElementById("preload"),T=document.getElementById("units");return M.onclick=function(){return""!=E.value&&(t("weather",null,null,function(e){n(e)},E.value),t("forecast/daily",null,null,function(e){r(e)},E.value)),!1},T.onclick=function(){"metric"==d.units?d.units="imperial":d.units="metric",t("weather",d.currentWeatherData.coord.lat,d.currentWeatherData.coord.lon,function(e){n(e)}),t("forecast/daily",d.currentWeatherData.coord.lat,d.currentWeatherData.coord.lon,function(e){r(e)})},{run:run}}();weatherWidget.run();